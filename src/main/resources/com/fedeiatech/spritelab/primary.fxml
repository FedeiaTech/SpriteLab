<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ColorPicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane fx:id="rootPane" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="600.0" minWidth="900.0" prefHeight="768.0" prefWidth="1200.0" stylesheets="@styles.css" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.fedeiatech.spritelab.PrimaryController">
   
   <left>
      <VBox prefHeight="700.0" prefWidth="350.0" spacing="12.0" styleClass="sidebar" BorderPane.alignment="CENTER">
         <padding>
            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
         </padding>
         <children>
            <Label text="SPRITE LAB" textFill="WHITE">
               <font> <Font name="System Bold" size="24.0" /> </font>
            </Label>
            <Label styleClass="label-subtitle" text="Universal 2D Sprite Sheet Generator" />
            
            <Separator opacity="0.3" />
            
            <Label styleClass="label-header" text="1. ARCHIVO DE ORIGEN" />
            <Button fx:id="btnCargar" maxWidth="1.7976931348623157E308" onAction="#onCargarVideo" prefHeight="35.0" text="ðŸ“‚  Cargar Video" />
            <Label fx:id="lblArchivoNombre" styleClass="label-subtitle" text="Esperando archivo..." wrapText="true" />

            <Separator opacity="0.3" />

            <Label styleClass="label-header" text="2. RECORTE DE TIEMPO" />
            <VBox fx:id="rangeSliderContainer" spacing="5.0" />
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <children>
                  <Label styleClass="label-subtitle" text="Inicio:" />
                  <TextField fx:id="txtStart" prefWidth="60.0" text="0.0" />
                  <Label styleClass="label-subtitle" text="Fin:" />
                  <TextField fx:id="txtEnd" prefWidth="60.0" text="0.0" />
                  <Label fx:id="lblDuracionRecorte" styleClass="label-subtitle" text="(0s)" />
               </children>
            </HBox>

            <Separator opacity="0.3" />

            <Label styleClass="label-header" text="3. CONFIGURACIÃ“N SPRITE" />
            <HBox alignment="CENTER_LEFT" spacing="10.0">
                <Label minWidth="30" text="FPS:" />
                <Slider fx:id="sliderFps" blockIncrement="1.0" majorTickUnit="12.0" max="60.0" min="1.0" value="12.0" HBox.hgrow="ALWAYS" />
                <TextField fx:id="txtFps" prefWidth="50.0" style="-fx-alignment: CENTER;" text="12" />
            </HBox>
            <HBox spacing="10.0">
               <children>
                  <VBox HBox.hgrow="ALWAYS">
                     <Label styleClass="label-subtitle" text="Altura (px):" />
                     <TextField fx:id="txtAltura" promptText="Auto" />
                  </VBox>
                  <VBox HBox.hgrow="ALWAYS">
                     <Label styleClass="label-subtitle" text="Ancho Calc:" />
                     <TextField fx:id="txtAnchoCalc" editable="false" promptText="..." />
                  </VBox>
               </children>
            </HBox>

            <Separator opacity="0.3" />

            <Label styleClass="label-header" text="4. LIMPIEZA DE FONDO" />
            <CheckBox fx:id="chkChroma" text="Activar Chroma Key" />
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <children>
                  <ColorPicker fx:id="colorPicker" prefWidth="120.0" promptText="Color" />
                  <ToggleButton fx:id="btnGotero" text="ðŸ–Œ Gotero" style="-fx-font-size: 11px;" />
               </children>
            </HBox>
            <VBox spacing="5.0">
               <Label styleClass="label-subtitle" text="Tolerancia:" />
               <Slider fx:id="sliderTolerancia" blockIncrement="0.05" max="0.6" value="0.15" />
            </VBox>

            <Separator opacity="0.3" />
            
            <VBox alignment="BOTTOM_CENTER" spacing="10.0" VBox.vgrow="ALWAYS">
               <HBox spacing="5.0">
                   <Button fx:id="btnPreview" maxWidth="1.7976931348623157E308" onAction="#onRefrescarPreview" prefHeight="35.0" text="ðŸ”„ Frame" HBox.hgrow="ALWAYS" />
                   <Button fx:id="btnVerSheet" maxWidth="1.7976931348623157E308" onAction="#onVerMiniatura" prefHeight="35.0" text="ðŸ‘ Ver Sheet" HBox.hgrow="ALWAYS" />
               </HBox>
               <Button fx:id="btnExportar" maxWidth="1.7976931348623157E308" onAction="#onExportar" prefHeight="50.0" styleClass="button-action" text="ðŸš€  EXPORTAR PNG" />
            </VBox>
         </children>
      </VBox>
   </left>
   
   <center>
      <StackPane fx:id="viewport" styleClass="viewport-bg">
         <children>
            <ScrollPane fx:id="scrollPreview" fitToHeight="true" fitToWidth="true" style="-fx-background: transparent; -fx-background-color: transparent;">
               <content>
                  <StackPane fx:id="previewContainer">
                     <children>
                        <ImageView fx:id="imgPreview" preserveRatio="true" />
                        <Label fx:id="lblInstrucciones" text="Carga un video o arrÃ¡stralo aquÃ­&#10;(Formatos: .MP4, .AVI, .MOV)" textAlignment="CENTER" textFill="#333333">
                           <font> <Font name="System Bold" size="20.0" /> </font>
                        </Label>
                     </children>
                  </StackPane>
               </content>
            </ScrollPane>
            
            <StackPane alignment="TOP_RIGHT" pickOnBounds="false" mouseTransparent="false">
                <padding><Insets top="15" right="25" /></padding>
                <HBox alignment="CENTER_RIGHT" spacing="10" maxHeight="-Infinity" maxWidth="-Infinity" style="-fx-background-color: rgba(0,0,0,0.7); -fx-background-radius: 20; -fx-padding: 5 15 5 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.5), 5, 0, 0, 0);">
                    <Label fx:id="lblZoomFactor" text="FIT" textFill="WHITE" style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                    <ToggleButton fx:id="btnZoomLock" selected="true" text="ðŸ”’ Ajustar" style="-fx-background-color: transparent; -fx-text-fill: white; -fx-border-color: white; -fx-border-radius: 10; -fx-padding: 3 8 3 8; -fx-cursor: hand;" />
                </HBox>
            </StackPane>
         </children>
      </StackPane>
   </center>
   
   <bottom>
       <HBox alignment="CENTER_LEFT" spacing="20" styleClass="status-bar" BorderPane.alignment="CENTER">
           <Label text="ESTADO:" styleClass="status-label" opacity="0.8"/>
           <Label fx:id="lblInfoGrilla" text="Listo" styleClass="status-label-bold"/>
           <Separator orientation="VERTICAL" />
           <Label fx:id="lblResolucionTotal" text="ResoluciÃ³n: -" styleClass="status-label"/>
       </HBox>
   </bottom>
</BorderPane>